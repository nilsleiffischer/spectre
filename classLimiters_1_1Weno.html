<!-- HTML header for doxygen 1.8.10-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="SXS Collaboration">
    <meta name="generator" content="Doxygen 1.8.17"/>
    <style>
        /*!
         * IE10 viewport hack for Surface/desktop Windows 8 bug
         * Copyright 2014-2015 Twitter, Inc.
         * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
         */
        @-webkit-viewport { width: device-width; }
        @-moz-viewport    { width: device-width; }
        @-ms-viewport     { width: device-width; }
        @-o-viewport      { width: device-width; }
        @viewport         { width: device-width; }
      </style>
  <title>SpECTRE: Limiters::Weno&lt; VolumeDim, TagsToLimit &gt; Class Template Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="./MathJax.js"></script>
  <link href="octicons.css" rel="stylesheet">
  <link href="bootstrap.min.css" rel="stylesheet">
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="popper.min.js"></script>
  <script type="text/javascript" src="bootstrap.min.js"></script>
  <script type="text/javascript" src="spectre.js"></script>
  </head>
  <body>
  <div id="top" class="navbar-fixed-top"><!-- do not remove this div, it is closed by doxygen! -->
  <!-- BEGIN TITLEAREA -->
  <div id="titlearea">
  <script type="text/javascript">
  var searchBox = new SearchBox("searchBox", "search",false,'Search');
  </script>
  <div id="main-nav">
    <ul class="sm sm-dox" id="main-menu">
      <li>
      <a href="index.html">
      SpECTRE &#160;
        <span id="projectnumber">v2021.07.08</span>
      </a>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="selected">
          <span id="selected">
            <i class="octicon octicon-book"></i><span>Documentation</span>
          </span>
          <span class="caret"></span>
        </a>
        <ul class="dropdown-menu">
          <li style="min-width: 135px;">
            <a href="index.html">
            <i class="octicon octicon-book"></i><span>Introduction</span></a>
          </li>
          <li style="min-width: 135px;">
            <a href="versioning_and_releases.html">
              <i class="octicon octicon-versions"></i><span>Releases</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="installation.html">
              <i class="octicon octicon-desktop-download"></i><span>Installation</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="tutorials.html">
              <i class="octicon octicon-mortar-board"></i><span>User Tutorials</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="dev_guide.html">
              <i class="octicon octicon-gist-secret"></i><span>Dev Guide</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="code_of_conduct.html">
              <i class="octicon octicon-comment-discussion"></i><span>Code of Conduct</span>
            </a>
          </li>
          <li style="min-width: 135px;">
            <a href="contributing_to_spectre.html">
              <i class="octicon octicon-git-pull-request"></i><span>Contributing Guide</span>
            </a>
          </li>
        </ul>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="selected">
          <span id="selected">
            <i class="octicon octicon-code"></i>
              <span>Code Reference</span>
          </span>
          <span class="caret"></span>
        </a>
        <ul class="dropdown-menu">
          <li style="min-width: 130px;">
            <a href="modules.html">
              <i class="octicon octicon-code"></i>
              <span>Topics</span>
            </a>
          </li>
          <li style="min-width: 130px;">
            <a href="namespaces.html">
              <i class="octicon octicon-gist"></i>
              <span>Namespaces</span>
            </a>
          </li>
        </ul>
      </li>
      <li>
        <a href="files.html">
          <i class="octicon octicon-file-directory"></i><span>Files</span>
        </a>
      </li>
      <li>
        <a href="citelist.html">
          <i class="octicon octicon-file-text"></i><span>Bibliography</span>
        </a>
      </li>
      <li>
        <a href="https://github.com/sxs-collaboration/spectre" target="_blank">
          <i class="octicon octicon-mark-github"></i><span>View on GitHub</span>
        </a>
      </li>
      <!--The Search <li> is added by doxygen later-->
    </ul>
  </div><!-- main-nav -->
  </div><!-- titlearea -->
  <!-- window showing the filter options -->
  <div id="MSearchSelectWindow"  style="position: fixed;"
       onmouseover="return searchBox.OnSearchSelectShow()"
       onmouseout="return searchBox.OnSearchSelectHide()"
       onkeydown="return searchBox.OnSearchSelectKey(event)">
  </div>
  <!-- iframe showing the search results (closed by default) -->
  <div id="MSearchResultsWindow"  style="position: fixed;">
  <iframe src="javascript:void(0)" frameborder="0"
          name="MSearchResults" id="MSearchResults">
  </iframe>
  </div>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceLimiters.html">Limiters</a></li><li class="navelem"><a class="el" href="classLimiters_1_1Weno.html">Weno</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Limiters::Weno&lt; VolumeDim, TagsToLimit &gt; Class Template Reference<div class="ingroups"><a class="el" href="group__LimitersGroup.html">Limiters</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>A compact-stencil WENO limiter for DG.  
 <a href="classLimiters_1_1Weno.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="DiscontinuousGalerkin_2Limiters_2Weno_8hpp_source.html">Weno.hpp</a>&gt;</code></p>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;size_t VolumeDim, typename TagsToLimit&gt;<br />
class Limiters::Weno&lt; VolumeDim, TagsToLimit &gt;</h3>

<p>A compact-stencil WENO limiter for DG. </p>
<p>Implements the simple WENO limiter of <a class="el" href="citelist.html#CITEREF_Zhong2013">[111]</a> and the Hermite WENO (HWENO) limiter of <a class="el" href="citelist.html#CITEREF_Zhu2016">[112]</a>. The implementation is system-agnostic and can act on an arbitrary set of tensors.</p>
<h4><a class="anchor" id="autotoc_md85"></a>
Summary of the compact-stencil WENO algorithms:</h4>
<p>The compact-stencil WENO limiters require communication only between nearest-neighbor elements, but aim to preserve the full order of the DG solution when the solution is smooth. To achieve this, full volume data is communicated between neighbors. For each tensor component to limit, the new solution is obtained by a standard WENO procedure &mdash; the new solution is a linear combination of different polynomials, with weights chosen so that the smoother (i.e., less oscillatory) polynomials contribute the most to the sum.</p>
<p>For the simple WENO and HWENO limiters, the polynomials used are the local DG solution as well as a "modified" solution from each neighbor element. For the simple WENO limiter, the modified solution is obtained by simply extrapolating the neighbor solution onto the troubled element. For the HWENO limiter, the modified solution is obtained by a least-squares fit to the solution across multiple neighboring elements.</p>
<h4><a class="anchor" id="autotoc_md86"></a>
Notes on the SpECTRE implemention of the WENO limiters:</h4>
<p>There are a few differences between the limiters as implemented in SpECTRE and as presented in the references. We list them here and discuss them further below.</p><ol type="1">
<li>The choice of basis to represent the DG solution</li>
<li>The system-agnostic implementation</li>
<li>The oscillation indicator</li>
</ol>
<p>Finally, in 4., we will discuss the geometric limitations of the implementation (which are not a deviation from the references).</p>
<p><a class="anchor" id="autotoc_md87"></a></p><h5>1. The choice of basis</h5>
<p>SpECTRE uses a Legendre basis, rather than the polynomial basis that we understand to be used in the references. Because the construction of the modified neighbor solutions and the WENO sum is geometrically motivated, the overall algorithm should work similarly. However, the precise numerics may differ.</p>
<p><a class="anchor" id="autotoc_md88"></a></p><h5>2. The system-agnostic implementation</h5>
<p>This implementation can act on an arbitrary set of tensors. To reach this generality, our HWENO implementation uses a different troubled-cell indicator (TCI) than the reference, which instead specializes the TCI to the Newtonian Euler system of equations.</p>
<p>This implementation uses the minmod-based TVB TCI of <a class="el" href="citelist.html#CITEREF_Cockburn1999">[28]</a> to identify elements that need limiting. The simple WENO implementation follows its reference: it checks the TCI independently for each tensor component, so that only certain tensor components may be limited. The HWENO implementation checks the TVB TCI for all tensor components, and if any single component is troubled, then all components of all tensors are limited.</p>
<p>When the evolution system has multiple evolved variables, the recommendation of the references is to apply the limiter to the system's characteristic variables to reduce spurious post-limiting oscillations. In SpECTRE, applying the limiter to the characteristic variables requires specializing the limiter to each evolution system. The system-specific limiter can also implement a system-specific TCI (as the HWENO reference does) to more precisely trigger the limiter.</p>
<p><a class="anchor" id="autotoc_md89"></a></p><h5>3. The oscillation indicator</h5>
<p>We use the oscillation indicator of <a class="el" href="citelist.html#CITEREF_Dumbser2007">[38]</a>, modified for use on the square/cube grids of SpECTRE. We favor this indicator because portions of the work can be precomputed, leading to an oscillation measure that is efficient to evaluate.</p>
<p><a class="anchor" id="autotoc_md90"></a></p><h5>4. The geometric limitations</h5>
<p>Does not support non-Legendre bases; this is checked in DEBUG mode. In principle other bases could be supported, but this would require generalizing the many internal algorithms that assume a Legendre basis.</p>
<p>Does not support h- or p-refinement; this is checked always. In principle this could be supported. The modified neighbor solution algorithm would need to be generalized (reasonable for simple WENO, extremely tedious for HWENO), and the sum of neighbor solutions may need to be updated as well.</p>
<p>Does not support curved elements; this is not enforced. The code will run but we make no guarantees about the results. Specifically, the limiter acts in the <code><a class="el" href="structFrame_1_1Logical.html">Frame::Logical</a></code> coordinates, because in these coordinates it is straightforward to formulate the algorithm. This means the limiter can operate on generic deformed grids &mdash; however, some things can start to break down, especially on strongly deformed grids:</p><ol type="1">
<li>When the Jacobian (from <code><a class="el" href="structFrame_1_1Logical.html">Frame::Logical</a></code> to <code><a class="el" href="structFrame_1_1Inertial.html">Frame::Inertial</a></code>) varies across the element, then the limiter fails to be conservative. This is because the integral of a tensor <code>u</code> over the element will change after the limiter activates on <code>u</code>.</li>
<li>When computing the modified neighbor solution for the WENO sum, the extrapolation or fitting procedure may not properly account for the coordinates of the source data. If the coordinate map of the neighbor differs from that of the local element, then the logical-coordinate representation of the neighbor data may be incorrect. This may be a large error at <a class="el" href="classBlock.html">Block</a> boundaries with discontinuous map changes, and may be a small error from smoothly-varying maps that are not sufficiently resolved from one element to the next. </li>
</ol>
</div><hr/>The documentation for this class was generated from the following file:<ul>
<li>src/Evolution/DiscontinuousGalerkin/Limiters/<a class="el" href="DiscontinuousGalerkin_2Limiters_2Weno_8hpp_source.html">Weno.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.10-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
&copy; Copyright 2017 - 2021
<a href="https://black-holes.org">SXS Collaboration</a>,
<a href="LICENSE.txt" target="_blank">
<span class="hidden-xs">Distributed under the</span>
MIT License</a>
</small></address>
</body>
</html>
